$(function(){function a(f){var d='<div class="card bg-light news-card block-comment" data-comment="'+f.id+'">';d+='<div class="card-body">';d+='<h6 class="card-subtitle mb-2 text-muted">'+f.author+"</h6>";d+="<small><i>"+f.date+"</i></small>";d+='<p class="card-text">'+f.text+"</p>";d+="</div></div>";if(f.parent>0){var e=$("#news-comment-block").children('[data-comment="'+f.parent+'"]');var g=$(d).insertAfter(e);g.addClass("block-comment-child")}else{var c='<button type="button" class="btn btn-secondary float-right" data-toggle="modal" data-target="#add-comment" data-parent="'+f.id+'" data-depth="1">Ответить</button>';var g=$(d).prependTo($("#news-comment-block"));g.find(".card-body").prepend(c)}$("#no-comments").addClass("d-none")}function b(c,d){console.log(d)}$("#add-comment").on("show.bs.modal",function(f){var d=$(this).find("form");var c=$(f.relatedTarget);d.find('input[name="parent"]').val(c.data("parent"));d.find('input[name="depth"]').val(c.data("depth"))});$("#add-comment-btn").click(function(){var c=$(this).closest(".modal-content");var e=c.find("button.close");var d=c.find("form");$.post("/ajax",d.serialize(),function(f){d.trigger("reset");if(f.status=="ok"){a(f.data);e.click()}else{b(d,f.errors)}},"json")})});